{"version":3,"file":"tippy-react-headless.umd.js","sources":["../../src/utils.js","../../src/util-hooks.js","../../src/className-plugin.js","../../src/Tippy.js","../../src/useSingleton.js","../../src/forwardRef.js","../../src/headless.js"],"sourcesContent":["export const isBrowser =\n  typeof window !== 'undefined' && typeof document !== 'undefined';\n\nexport function preserveRef(ref, node) {\n  if (ref) {\n    if (typeof ref === 'function') {\n      ref(node);\n    }\n    if ({}.hasOwnProperty.call(ref, 'current')) {\n      ref.current = node;\n    }\n  }\n}\n\nexport function ssrSafeCreateDiv() {\n  return isBrowser && document.createElement('div');\n}\n\nexport function toDataAttributes(attrs) {\n  const dataAttrs = {\n    'data-placement': attrs.placement,\n  };\n\n  if (attrs.referenceHidden) {\n    dataAttrs['data-reference-hidden'] = '';\n  }\n\n  if (attrs.escaped) {\n    dataAttrs['data-escaped'] = '';\n  }\n\n  return dataAttrs;\n}\n\nexport function deepPreserveProps(instanceProps, componentProps) {\n  return {\n    ...componentProps,\n    popperOptions: {\n      ...instanceProps.popperOptions,\n      ...componentProps.popperOptions,\n      modifiers: [\n        // Preserve tippy's internal + plugin modifiers\n        ...(instanceProps.popperOptions?.modifiers || []).filter(\n          modifier => modifier.name.indexOf('tippy') >= 0,\n        ),\n        ...(componentProps.popperOptions?.modifiers || []),\n      ],\n    },\n  };\n}\n","import {isBrowser} from './utils';\nimport {useLayoutEffect, useEffect, useRef} from 'react';\n\nexport const useIsomorphicLayoutEffect = isBrowser\n  ? useLayoutEffect\n  : useEffect;\n\nexport function useMutableBox(initialValue) {\n  // Using refs instead of state as it's recommended to not store imperative\n  // values in state due to memory problems in React(?)\n  const ref = useRef();\n\n  if (!ref.current) {\n    ref.current =\n      typeof initialValue === 'function' ? initialValue() : initialValue;\n  }\n\n  return ref.current;\n}\n","function updateClassName(box, action, classNames) {\n  classNames.split(/\\s+/).forEach(name => {\n    if (name) {\n      box.classList[action](name);\n    }\n  });\n}\n\nexport const classNamePlugin = {\n  name: 'className',\n  defaultValue: '',\n  fn(instance) {\n    const box = instance.popper.firstElementChild;\n    const isDefaultRenderFn = () => !!instance.props.render?.$$tippy;\n\n    function add() {\n      if (instance.props.className && !isDefaultRenderFn()) {\n        if (process.env.NODE_ENV !== 'production') {\n          console.warn(\n            [\n              '@tippyjs/react: Cannot use `className` prop in conjunction with',\n              '`render` prop. Place the className on the element you are',\n              'rendering.',\n            ].join(' '),\n          );\n        }\n\n        return;\n      }\n\n      updateClassName(box, 'add', instance.props.className);\n    }\n\n    function remove() {\n      if (isDefaultRenderFn()) {\n        updateClassName(box, 'remove', instance.props.className);\n      }\n    }\n\n    return {\n      onCreate: add,\n      onBeforeUpdate: remove,\n      onAfterUpdate: add,\n    };\n  },\n};\n","import React, {cloneElement, useState} from 'react';\nimport PropTypes from 'prop-types';\nimport {createPortal} from 'react-dom';\nimport {\n  preserveRef,\n  ssrSafeCreateDiv,\n  toDataAttributes,\n  deepPreserveProps,\n} from './utils';\nimport {useMutableBox, useIsomorphicLayoutEffect} from './util-hooks';\nimport {classNamePlugin} from './className-plugin';\n\nexport default function TippyGenerator(tippy) {\n  function Tippy({\n    children,\n    content,\n    visible,\n    singleton,\n    render,\n    disabled = false,\n    ignoreAttributes = true,\n    // Filter React development reserved props\n    // added by babel-preset-react dev plugins:\n    // transform-react-jsx-self and transform-react-jsx-source\n    __source,\n    __self,\n    ...restOfNativeProps\n  }) {\n    const isControlledMode = visible !== undefined;\n    const isSingletonMode = singleton !== undefined;\n\n    const [attrs, setAttrs] = useState({});\n    const [mounted, setMounted] = useState(false);\n    const [singletonContent, setSingletonContent] = useState();\n    const mutableBox = useMutableBox(() => ({\n      container: ssrSafeCreateDiv(),\n      renders: 1,\n    }));\n\n    const props = {\n      ignoreAttributes,\n      ...restOfNativeProps,\n      content: mutableBox.container,\n    };\n\n    if (isControlledMode) {\n      if (process.env.NODE_ENV !== 'production') {\n        ['trigger', 'hideOnClick', 'showOnCreate'].forEach(nativeStateProp => {\n          if (props[nativeStateProp] !== undefined) {\n            console.warn(\n              [\n                `@tippyjs/react: Cannot specify \\`${nativeStateProp}\\` prop in`,\n                `controlled mode (\\`visible\\` prop)`,\n              ].join(' '),\n            );\n          }\n        });\n      }\n\n      props.trigger = 'manual';\n      props.hideOnClick = false;\n    }\n\n    if (isSingletonMode) {\n      disabled = true;\n    }\n\n    let computedProps = props;\n    const plugins = props.plugins || [];\n\n    if (render) {\n      computedProps = {\n        ...props,\n        plugins: isSingletonMode\n          ? [\n              ...plugins,\n              {\n                fn: () => ({\n                  onTrigger(_, event) {\n                    const {content} = singleton.data.children.find(\n                      ({instance}) =>\n                        instance.reference === event.currentTarget,\n                    );\n                    setSingletonContent(content);\n                  },\n                }),\n              },\n            ]\n          : plugins,\n        render: () => ({popper: mutableBox.container}),\n      };\n    }\n\n    const deps = children ? [children.type] : [];\n\n    // CREATE\n    useIsomorphicLayoutEffect(() => {\n      const instance = tippy(mutableBox.ref || ssrSafeCreateDiv(), {\n        ...computedProps,\n        plugins: [classNamePlugin, ...(props.plugins || [])],\n      });\n\n      mutableBox.instance = instance;\n\n      if (disabled) {\n        instance.disable();\n      }\n\n      if (visible) {\n        instance.show();\n      }\n\n      if (isSingletonMode) {\n        singleton.hook({\n          instance,\n          content,\n          props: computedProps,\n        });\n      }\n\n      setMounted(true);\n\n      return () => {\n        instance.destroy();\n        singleton?.cleanup(instance);\n      };\n    }, deps);\n\n    // UPDATE\n    useIsomorphicLayoutEffect(() => {\n      // Prevent this effect from running on 1st render\n      if (mutableBox.renders === 1) {\n        mutableBox.renders++;\n        return;\n      }\n\n      const {instance} = mutableBox;\n\n      instance.setProps(deepPreserveProps(instance.props, props));\n\n      if (disabled) {\n        instance.disable();\n      } else {\n        instance.enable();\n      }\n\n      if (isControlledMode) {\n        if (visible) {\n          instance.show();\n        } else {\n          instance.hide();\n        }\n      }\n\n      if (isSingletonMode) {\n        singleton.hook({\n          instance,\n          content,\n          props,\n        });\n      }\n    });\n\n    useIsomorphicLayoutEffect(() => {\n      if (!render) {\n        return;\n      }\n\n      const {instance} = mutableBox;\n\n      instance.setProps({\n        popperOptions: {\n          ...instance.props.popperOptions,\n          modifiers: [\n            ...(instance.props.popperOptions?.modifiers || []),\n            {\n              name: '$$tippyReact',\n              enabled: true,\n              phase: 'beforeWrite',\n              requires: ['computeStyles'],\n              fn({state}) {\n                const hideData = state.modifiersData?.hide;\n\n                // WARNING: this is a high-risk path that can cause an infinite\n                // loop. This expression _must_ evaluate to false when required\n                if (\n                  attrs.placement !== state.placement ||\n                  attrs.referenceHidden !== hideData?.isReferenceHidden ||\n                  attrs.escaped !== hideData?.hasPopperEscaped\n                ) {\n                  setAttrs({\n                    placement: state.placement,\n                    referenceHidden: hideData?.isReferenceHidden,\n                    escaped: hideData?.hasPopperEscaped,\n                  });\n                }\n\n                state.attributes.popper = {};\n              },\n            },\n          ],\n        },\n      });\n    }, [attrs.placement, attrs.referenceHidden, attrs.escaped, ...deps]);\n\n    return (\n      <>\n        {children\n          ? cloneElement(children, {\n              ref(node) {\n                mutableBox.ref = node;\n                preserveRef(children.ref, node);\n              },\n            })\n          : null}\n        {mounted &&\n          createPortal(\n            render\n              ? render(toDataAttributes(attrs), singletonContent)\n              : content,\n            mutableBox.container,\n          )}\n      </>\n    );\n  }\n\n  if (process.env.NODE_ENV !== 'production') {\n    const ContentType = PropTypes.oneOfType([\n      PropTypes.number,\n      PropTypes.string,\n      PropTypes.element,\n    ]);\n\n    Tippy.propTypes = {\n      children: PropTypes.element,\n      content: PropTypes.oneOfType([\n        ContentType,\n        PropTypes.arrayOf(ContentType),\n      ]),\n      render: PropTypes.func,\n      visible: PropTypes.bool,\n      disabled: PropTypes.bool,\n      className: PropTypes.string,\n      singleton: PropTypes.object,\n    };\n  }\n\n  return Tippy;\n}\n","import {useMutableBox, useIsomorphicLayoutEffect} from './util-hooks';\nimport {deepPreserveProps} from './utils';\nimport {classNamePlugin} from './className-plugin';\nimport {useMemo} from 'react';\n\nexport default function useSingletonGenerator(createSingleton) {\n  return function useSingleton({disabled = false, overrides = []} = {}) {\n    const mutableBox = useMutableBox({\n      children: [],\n      renders: 1,\n    });\n\n    useIsomorphicLayoutEffect(() => {\n      const {children, sourceData} = mutableBox;\n\n      if (!sourceData) {\n        if (process.env.NODE_ENV !== 'production') {\n          console.error(\n            [\n              '@tippyjs/react: The `source` variable from `useSingleton()` has',\n              'not been passed to a <Tippy /> component.',\n            ].join(' '),\n          );\n        }\n\n        return;\n      }\n\n      const instance = createSingleton(\n        children.map(child => child.instance),\n        {\n          ...sourceData.props,\n          popperOptions: sourceData.instance.props.popperOptions,\n          overrides,\n          plugins: [classNamePlugin, ...(sourceData.props.plugins || [])],\n        },\n      );\n\n      mutableBox.instance = instance;\n\n      if (disabled) {\n        instance.disable();\n      }\n\n      return () => {\n        instance.destroy();\n        mutableBox.children = children.filter(\n          ({instance}) => !instance.state.isDestroyed,\n        );\n      };\n    }, []);\n\n    useIsomorphicLayoutEffect(() => {\n      if (mutableBox.renders === 1) {\n        mutableBox.renders++;\n        return;\n      }\n\n      const {children, instance, sourceData} = mutableBox;\n\n      if (!(instance && sourceData)) {\n        return;\n      }\n\n      const {content, ...props} = sourceData.props;\n      instance.setProps(\n        deepPreserveProps(instance, {\n          ...props,\n          overrides,\n        }),\n      );\n\n      instance.setInstances(children.map(child => child.instance));\n\n      if (disabled) {\n        instance.disable();\n      } else {\n        instance.enable();\n      }\n    });\n\n    return useMemo(() => {\n      const source = {\n        data: mutableBox,\n        hook(data) {\n          mutableBox.sourceData = data;\n        },\n        cleanup() {\n          mutableBox.sourceData = null;\n        },\n      };\n\n      const target = {\n        hook(data) {\n          if (\n            !mutableBox.children.find(\n              ({instance}) => data.instance === instance,\n            )\n          ) {\n            mutableBox.children.push(data);\n          }\n        },\n        cleanup(instance) {\n          mutableBox.children = mutableBox.children.filter(\n            data => data.instance !== instance,\n          );\n        },\n      };\n\n      return [source, target];\n    }, []);\n  };\n}\n","import React, {cloneElement, forwardRef} from 'react';\nimport {preserveRef} from './utils';\n\nexport default (Tippy, defaultProps) =>\n  forwardRef(function TippyWrapper({children, ...props}, ref) {\n    return (\n      // If I spread them separately here, Babel adds the _extends ponyfill for\n      // some reason\n      <Tippy {...{...defaultProps, ...props}}>\n        {children\n          ? cloneElement(children, {\n              ref(node) {\n                preserveRef(ref, node);\n                preserveRef(children.ref, node);\n              },\n            })\n          : null}\n      </Tippy>\n    );\n  });\n","import tippy, {createSingleton} from 'tippy.js/headless';\nimport TippyGenerator from './Tippy';\nimport useSingletonGenerator from './useSingleton';\nimport forwardRef from './forwardRef';\n\nconst useSingleton = useSingletonGenerator(createSingleton);\n\nexport default forwardRef(TippyGenerator(tippy), {render: () => ''});\nexport {useSingleton, tippy};\n"],"names":["isBrowser","window","document","preserveRef","ref","node","hasOwnProperty","call","current","ssrSafeCreateDiv","createElement","toDataAttributes","attrs","dataAttrs","placement","referenceHidden","escaped","deepPreserveProps","instanceProps","componentProps","popperOptions","modifiers","filter","modifier","name","indexOf","useIsomorphicLayoutEffect","useLayoutEffect","useEffect","useMutableBox","initialValue","useRef","updateClassName","box","action","classNames","split","forEach","classList","classNamePlugin","defaultValue","fn","instance","popper","firstElementChild","isDefaultRenderFn","props","render","$$tippy","add","className","process","env","NODE_ENV","console","warn","join","remove","onCreate","onBeforeUpdate","onAfterUpdate","TippyGenerator","tippy","Tippy","children","content","visible","singleton","disabled","ignoreAttributes","__source","__self","restOfNativeProps","isControlledMode","undefined","isSingletonMode","useState","setAttrs","mounted","setMounted","singletonContent","setSingletonContent","mutableBox","container","renders","nativeStateProp","trigger","hideOnClick","computedProps","plugins","onTrigger","_","event","data","find","reference","currentTarget","deps","type","disable","show","hook","destroy","cleanup","setProps","enable","hide","enabled","phase","requires","state","hideData","modifiersData","isReferenceHidden","hasPopperEscaped","attributes","React","cloneElement","createPortal","ContentType","PropTypes","oneOfType","number","string","element","propTypes","arrayOf","func","bool","object","useSingletonGenerator","createSingleton","useSingleton","overrides","sourceData","error","map","child","isDestroyed","setInstances","useMemo","source","target","push","defaultProps","forwardRef","TippyWrapper"],"mappings":"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"}